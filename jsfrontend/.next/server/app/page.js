(()=>{var e={};e.id=931,e.ids=[931],e.modules={5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5528:e=>{"use strict";e.exports=require("next/dist\\client\\components\\action-async-storage.external.js")},1877:e=>{"use strict";e.exports=require("next/dist\\client\\components\\request-async-storage.external.js")},5319:e=>{"use strict";e.exports=require("next/dist\\client\\components\\static-generation-async-storage.external.js")},9491:e=>{"use strict";e.exports=require("assert")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},7147:e=>{"use strict";e.exports=require("fs")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1017:e=>{"use strict";e.exports=require("path")},2781:e=>{"use strict";e.exports=require("stream")},7310:e=>{"use strict";e.exports=require("url")},3837:e=>{"use strict";e.exports=require("util")},9796:e=>{"use strict";e.exports=require("zlib")},5191:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var r=s(7096),a=s(6132),i=s(7284),n=s.n(i),o=s(2564),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);s.d(t,l);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,8203)),"D:\\OneDrive - HKUST Connect\\Projects\\FYP\\jsfrontend\\src\\app\\page.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,9113)),"D:\\OneDrive - HKUST Connect\\Projects\\FYP\\jsfrontend\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9291,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["D:\\OneDrive - HKUST Connect\\Projects\\FYP\\jsfrontend\\src\\app\\page.tsx"],u="/page",p={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},381:(e,t,s)=>{Promise.resolve().then(s.bind(s,1914))},1914:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>page});var r=s(784),a=s(9885);s(8604);let components_history=({history:e,activeChat:t,onSelectChat:s,onNewChat:a,onDeleteChat:i})=>{let handleDelete=(e,t)=>{e.stopPropagation(),i(t)};return(0,r.jsxs)("div",{className:"chat-history",children:[r.jsx("button",{className:"new-chat-setting-button",onClick:a,children:"Add New Chat"}),r.jsx("button",{className:"new-chat-setting-button",children:"Setting"}),r.jsx("div",{className:"history-list",children:e.map(e=>(0,r.jsxs)("div",{className:`history-item ${t===e.id?"active":""}`,onClick:()=>s(e.id),children:[r.jsx("div",{className:"history-item-title",children:e.title}),r.jsx("button",{className:"delete-button",onClick:t=>handleDelete(t,e.id),children:"\uD83D\uDDD1️"})]},e.id))})]})},components_message=({message:e})=>{let t=e.audioFile?URL.createObjectURL(e.audioFile):null;return r.jsx("div",{className:`message ${e.sender}`,children:(0,r.jsxs)("div",{className:"message-content",children:["user"===e.sender&&e.audioFile&&(0,r.jsxs)("div",{children:[e.text&&r.jsx("div",{className:"message-text",children:e.text}),(0,r.jsxs)("div",{children:[r.jsx("audio",{controls:!0,src:t||void 0,children:"Your browser does not support audio."}),r.jsx("span",{className:"audio-label",children:"Your audio"})]})]}),"user"===e.sender&&!e.audioFile&&r.jsx("div",{className:"message-text",children:e.text}),"ai"===e.sender&&e.audioUrl&&(0,r.jsxs)("div",{children:[r.jsx("div",{className:"message-text",children:e.text}),(0,r.jsxs)("div",{children:[r.jsx("audio",{controls:!0,src:e.audioUrl,children:"Your browser does not support audio."}),r.jsx("span",{className:"audio-label",children:"Generated music"})]})]}),"ai"===e.sender&&!e.audioUrl&&r.jsx("div",{className:"message-text",children:e.text}),e.error&&r.jsx("div",{className:"error-message",children:"⚠️ Error generating music"})]})})},chatbot=({messages:e})=>r.jsx("div",{className:"chat-main",children:r.jsx("div",{className:"messages-container",children:e.map(e=>r.jsx(components_message,{message:e},e.id))})}),input=({onSendMessage:e,pendingAudio:t,setPendingAudio:s})=>{let[i,n]=(0,a.useState)(""),o=(0,a.useRef)(null);return(0,r.jsxs)("form",{className:"chat-input",onSubmit:s=>{s.preventDefault(),(i.trim()||t)&&(e(i,t||void 0),n(""))},children:[r.jsx("input",{type:"text",value:i,onChange:e=>n(e.target.value),placeholder:"Describe your music..."}),r.jsx("input",{type:"file",ref:o,onChange:e=>{let t=e.target.files?.[0];t&&s(t)},accept:"audio/*",style:{display:"none"}}),(0,r.jsxs)("div",{className:"audio-controls",children:[r.jsx("button",{type:"button",className:`audio-button ${t?"active":""}`,onClick:()=>o.current?.click(),children:t?"Uploaded":"Add Audio"}),t&&(0,r.jsxs)("div",{className:"audio-preview",children:[r.jsx("span",{children:t.name}),r.jsx("button",{type:"button",className:"remove-audio",onClick:()=>{s(null),o.current&&(o.current.value="")},children:"\xd7"})]})]}),r.jsx("button",{type:"submit",className:"send-button",disabled:!i&&!t,children:"Send"})]})};var i=s(1145);let page=()=>{let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(()=>[{id:"1",title:"New Chat",messages:[{id:"1",text:"Hello! Describe your music or upload audio to generate!",sender:"ai"}]}]),[o,l]=(0,a.useState)("1"),[d,c]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=s.find(e=>e.id===o);e?t(e.messages):t([])},[o,s]);let updateHistory=e=>{n(t=>t.map(t=>t.id===o?{...t,messages:[...t.messages,e],title:1===t.messages.length&&"user"===e.sender?e.text.slice(0,30)+(e.text.length>30?"...":""):t.title}:t))},handleSendMessage=async(e,s)=>{let r={id:Date.now().toString(),text:e||(s?"Audio input":""),sender:"user",isAudio:!!s,audioFile:s};t(e=>[...e,r]),updateHistory(r),c(null);try{let r=new FormData;r.append("prompt",e||"Generate music"),r.append("duration",String(30)),s&&r.append("audio_input",s);let a=await fetch("http://localhost:8000/generate-music/",{method:"POST",body:r});if(!a.ok){let e=await a.json();throw console.error("Error details:",e),Error(e.detail||"Failed to generate music")}let n=await a.blob(),o=URL.createObjectURL(n),l=await i.Z.post("http://localhost:8001/generate",{text:e}),d={id:Date.now().toString(),text:e?l.data.text:"Generated music",sender:"ai",audioUrl:o};t(e=>[...e,d]),updateHistory(d)}catch(s){console.error("Error:",s);let e={id:Date.now().toString(),text:"Error generating music",sender:"ai",error:!0};t(t=>[...t,e]),updateHistory(e)}};return(0,r.jsxs)("div",{className:"app",children:[r.jsx(components_history,{history:s,activeChat:o,onSelectChat:l,onNewChat:()=>{let e=Date.now().toString(),t={id:e,title:"New Chat",messages:[{id:"1",text:"Hello! Describe your music or upload audio to generate!",sender:"ai"}]};n(e=>[t,...e]),l(e),c(null)},onDeleteChat:e=>{n(t=>t.filter(t=>t.id!==e)),e===o&&l(t=>{let r=s.filter(t=>t.id!==e);return r.length>0?r[0].id:""})}}),(0,r.jsxs)("div",{className:"chat-container",children:[r.jsx(chatbot,{messages:e}),r.jsx(input,{onSendMessage:handleSendMessage,pendingAudio:d,setPendingAudio:c})]})]})}},8203:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>i,default:()=>l});var r=s(5153);let a=(0,r.createProxy)(String.raw`D:\OneDrive - HKUST Connect\Projects\FYP\jsfrontend\src\app\page.tsx`),{__esModule:i,$$typeof:n}=a,o=a.default,l=o},3881:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var r=s(8531);let __WEBPACK_DEFAULT_EXPORT__=e=>{let t=(0,r.fillMetadataSegment)(".",e.params,"favicon.ico");return[{type:"image/x-icon",sizes:"32x14",url:t+""}]}},8604:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),s=t.X(0,[164,782,923],()=>__webpack_exec__(5191));module.exports=s})();